!function(t){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(e){return t(e,window,document)}):"object"==typeof exports?module.exports=function(e,o){return e||(e=window),o&&o.fn.dataTable||(o=require("datatables.net")(e,o).$),t(o,e,e.document)}:t(jQuery,window,document)}(function(t,e,o,r){"use strict";var s=t.fn.dataTable,n=function(e,o){if(!s.versionCheck||!s.versionCheck("1.10.8"))throw"DataTables RowReorder requires DataTables 1.10.8 or newer";this.c=t.extend(!0,{},s.defaults.rowReorder,n.defaults,o),this.s={bodyTop:null,dt:new s.Api(e),getDataFn:s.ext.oApi._fnGetObjectDataFn(this.c.dataSrc),middles:null,scroll:{},scrollInterval:null,setDataFn:s.ext.oApi._fnSetObjectDataFn(this.c.dataSrc),start:{top:0,left:0,offsetTop:0,offsetLeft:0,nodes:[]},windowHeight:0},this.dom={clone:null,dtScroll:t("div.dataTables_scrollBody",this.s.dt.table().container())};var r=this.s.dt.settings()[0],i=r.rowreorder;return i?i:(r.rowreorder=this,void this._constructor())};return t.extend(n.prototype,{_constructor:function(){var e=this,o=this.s.dt,r=t(o.table().node());"static"===r.css("position")&&r.css("position","relative"),t(o.table().container()).on("mousedown.rowReorder touchstart.rowReorder",this.c.selector,function(r){var s=t(this).closest("tr");if(o.row(s).any())return e._mouseDown(r,s),!1}),o.on("destroy.rowReorder",function(){t(o.table().container()).off(".rowReorder"),o.off(".rowReorder")})},_cachePositions:function(){var o=this.s.dt,r=t(o.table().node()).find("thead").outerHeight(),s=t.unique(o.rows({page:"current"}).nodes().toArray()),n=t.map(s,function(e,o){return t(e).position().top-r}),i=t.map(n,function(e,r){return n.length<r-1?(e+n[r+1])/2:(e+e+t(o.row(":last-child").node()).outerHeight())/2});this.s.middles=i,this.s.bodyTop=t(o.table().body()).offset().top,this.s.windowHeight=t(e).height()},_clone:function(e){var o=this.s.dt,r=t(o.table().node().cloneNode(!1)).addClass("dt-rowReorder-float").append("<tbody/>").append(e.clone(!1)),s=e.outerWidth(),n=e.outerHeight(),i=e.children().map(function(){return t(this).width()});r.width(s).height(n).find("tr").children().each(function(t){this.style.width=i[t]+"px"}),r.appendTo("body"),this.dom.clone=r},_clonePosition:function(t){var e,o=this.s.start,r=this._eventToPage(t,"Y")-o.top,s=this._eventToPage(t,"X")-o.left,n=this.c.snapX;e=n===!0?o.offsetLeft:"number"==typeof n?o.offsetLeft+n:s+o.offsetLeft,this.dom.clone.css({top:r+o.offsetTop,left:e})},_emitEvent:function(e,o){this.s.dt.iterator("table",function(r,s){t(r.nTable).triggerHandler(e+".dt",o)})},_eventToPage:function(t,e){return t.type.indexOf("touch")!==-1?t.originalEvent.touches[0]["page"+e]:t["page"+e]},_mouseDown:function(r,s){var n=this,i=this.s.dt,d=this.s.start,a=s.offset();d.top=this._eventToPage(r,"Y"),d.left=this._eventToPage(r,"X"),d.offsetTop=a.top,d.offsetLeft=a.left,d.nodes=t.unique(i.rows({page:"current"}).nodes().toArray()),this._cachePositions(),this._clone(s),this._clonePosition(r),this.dom.target=s,s.addClass("dt-rowReorder-moving"),t(o).on("mouseup.rowReorder touchend.rowReorder",function(t){n._mouseUp(t)}).on("mousemove.rowReorder touchmove.rowReorder",function(t){n._mouseMove(t)}),t(e).width()===t(o).width()&&t(o.body).addClass("dt-rowReorder-noOverflow");var l=this.dom.dtScroll;this.s.scroll={windowHeight:t(e).height(),windowWidth:t(e).width(),dtTop:l.length?l.offset().top:null,dtLeft:l.length?l.offset().left:null,dtHeight:l.length?l.outerHeight():null,dtWidth:l.length?l.outerWidth():null}},_mouseMove:function(e){this._clonePosition(e);for(var o=this._eventToPage(e,"Y")-this.s.bodyTop,r=this.s.middles,s=null,n=this.s.dt,i=n.table().body(),d=0,a=r.length;d<a;d++)if(o<r[d]){s=d;break}if(null===s&&(s=r.length),null===this.s.lastInsert||this.s.lastInsert!==s){if(0===s)this.dom.target.prependTo(i);else{var l=t.unique(n.rows({page:"current"}).nodes().toArray());s>this.s.lastInsert?this.dom.target.insertAfter(l[s-1]):this.dom.target.insertBefore(l[s])}this._cachePositions(),this.s.lastInsert=s}this._shiftScroll(e)},_mouseUp:function(e){var r,s,n=this.s.dt,i=this.c.dataSrc;this.dom.clone.remove(),this.dom.clone=null,this.dom.target.removeClass("dt-rowReorder-moving"),t(o).off(".rowReorder"),t(o.body).removeClass("dt-rowReorder-noOverflow"),clearInterval(this.s.scrollInterval),this.s.scrollInterval=null;var d=this.s.start.nodes,a=t.unique(n.rows({page:"current"}).nodes().toArray()),l={},h=[],c=[],f=this.s.getDataFn,u=this.s.setDataFn;for(r=0,s=d.length;r<s;r++)if(d[r]!==a[r]){var w=n.row(a[r]).id(),p=n.row(a[r]).data(),v=n.row(d[r]).data();w&&(l[w]=f(v)),h.push({node:a[r],oldData:f(p),newData:f(v),newPosition:r,oldPosition:t.inArray(a[r],d)}),c.push(a[r])}var g=[h,{dataSrc:i,nodes:c,values:l,triggerRow:n.row(this.dom.target)}];if(this._emitEvent("row-reorder",g),this.c.editor&&this.c.editor.edit(c,!1,t.extend({submit:"changed"},this.c.formOptions)).multiSet(i,l).submit(),this.c.update){for(r=0,s=h.length;r<s;r++){var m=n.row(h[r].node),b=m.data();u(b,h[r].newData),n.columns().every(function(){this.dataSrc()===i&&n.cell(h[r].node,this.index()).invalidate("data")})}this._emitEvent("row-reordered",g),n.draw(!1)}},_shiftScroll:function(t){var e,r,s=this,n=(this.s.dt,this.s.scroll),i=!1,d=5,a=65,l=t.pageY-o.body.scrollTop;l<a?e=d*-1:l>n.windowHeight-a&&(e=d),null!==n.dtTop&&t.pageY<n.dtTop+a?r=d*-1:null!==n.dtTop&&t.pageY>n.dtTop+n.dtHeight-a&&(r=d),e||r?(n.windowVert=e,n.dtVert=r,i=!0):this.s.scrollInterval&&(clearInterval(this.s.scrollInterval),this.s.scrollInterval=null),!this.s.scrollInterval&&i&&(this.s.scrollInterval=setInterval(function(){if(n.windowVert&&(o.body.scrollTop+=n.windowVert),n.dtVert){var t=s.dom.dtScroll[0];n.dtVert&&(t.scrollTop+=n.dtVert)}},20))}}),n.defaults={dataSrc:0,editor:null,formOptions:{},selector:"td:first-child",snapX:!1,update:!0},n.version="1.1.3-dev",t.fn.dataTable.RowReorder=n,t.fn.DataTable.RowReorder=n,t(o).on("init.dt.dtr",function(e,o,r){if("dt"===e.namespace){var i=o.oInit.rowReorder,d=s.defaults.rowReorder;if(i||d){var a=t.extend({},i,d);i!==!1&&new n(o,a)}}}),n});