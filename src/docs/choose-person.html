<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>choose person</title>
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../iconfont/iconfont.css" />
    <link rel="stylesheet" href="../css/cross.css" />
    <link rel="stylesheet" href="../css/docs.css" />
    <link rel="stylesheet" href="../css/highlight.css" />
    <link rel="stylesheet" href="../css/ztree.css" />
    <link rel="stylesheet" href="../css/artdialog.css" />
    <link rel="stylesheet" href="../css/chooseperson.css" />
</head>
<body>
<div class="p-medium">
    <fieldset class="c-field">
        <legend>引用</legend>
        <div class="c-field-box">
<pre><code class="html c-break">
    &lt;link rel="stylesheet" href="../css/ztree.css" /&gt;
    &lt;link rel="stylesheet" href="../css/artdialog.css" /&gt;
    &lt;link rel="stylesheet" href="../css/chooseperson.css" /&gt;
    &lt;script type="text/javascript" src="../js/ztree/ztree.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" src="../js/artdialog/artdialog.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" src="../js/chooseperson/chooseperson.js"&gt;&lt;/script&gt;
</code></pre>
        </div>
    </fieldset>

    <div class="c-border p-small border-radius-rounded mt-medium">

        <div class="form-layout form-horizontal form-horizontal-narrow">
            <div class="control-group">
                <label class="control-label"><sub class="control-sub">*</sub> 人员选择：</label>
                <div class="control-form">
                    <textarea class="c-input" rows="5" cols="65" placeholder="请选择人员" data-name="林仙花1,林毅1" data-id="B06AAE3CB22D45BCB1F88F8CD6CD3C54,662ABB18D95542CF8979A53226AFA53B" id="choose-person-input">林仙花,林毅</textarea>
                    <a class="button button-primary button-rounded" href="javascript:;" id="choose-person-btn">选择</a>
                </div>
            </div>
        </div>

        <fieldset class="c-field c-field-title mt-medium">
            <legend class="fs6">人员选择</legend>
        </fieldset>
        <div class="c-field-box c-position-r">
            <div class="c-position-a" style="top: 0; right: 0">
                <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" class="border-radius-circle c-border "><i class="iconfont icon-angledown c-gray"></i></a>
            </div>
            <div class="introduce">
                内容区域
            </div>
        </div>

        <div id="collapseTwo" class="c-panel-bd c-panel-collapse mt-medium">
            <div class="tabs tabs-thr tabs-thr-medium c-position-r" data-toggle="tabs">
                <div class="tabs-hd clearfix">
                    <a href="javascript:;" class="curr"><span>HTML</span></a>
                    <a href="javascript:;"><span>Javascript</span></a>
                </div>
                <div class="tabs-bd">
                    <div class="tabs-bd-box c-hide curr p-small">
<pre><code class="html c-break">
    &lt;div class="form-layout form-horizontal form-horizontal-narrow"&gt;
        &lt;div class="control-group"&gt;
            &lt;label class="control-label"&gt;&lt;sub class="control-sub"&gt;*&lt;/sub&gt; 人员选择：&lt;/label&gt;
            &lt;div class="control-form"&gt;
                &lt;textarea class="c-input" rows="5" cols="65" placeholder="请选择人员" data-name="林仙花1,林毅1" data-id="B06AAE3CB22D45BCB1F88F8CD6CD3C54,662ABB18D95542CF8979A53226AFA53B" id="choose-person-input"&gt;林仙花,林毅&lt;/textarea&gt;
                &lt;a class="button button-primary button-rounded" href="javascript:;" id="choose-person-btn"&gt;选择&lt;/a&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
</code></pre>
                    </div>
                    <div class="tabs-bd-box c-hide p-small">
<pre><code class="javascript">
    $('#choose-person-btn').on('click',function(){
        chooseperson({
            initDataId:$('#choose-person-input').attr('data-id'),
            initDataName:$('#choose-person-input').attr('data-name'),
            ztreeJsonUrl:'../json/chooseperson/choosepersonztree.json',
            searchJsonUrl:'../json/chooseperson/choosepersonsearch.json',
            artDialogTitle: '请选择人员',
            callBack:function(value){
                filledData(value,'#choose-person-input');
            }
        });
    });

    function filledData(value,dom){
        var _name=_id='';
        $(value).each(function(i,v){
            _name+= v.name+",";
            _id+= v.id+",";
        });
        _name=_name.substring(0,_name.length-1);
        _id=_id.substring(0,_id.length-1);
        $(dom).val(_name).attr({'data-name':_name,'data-id':_id});
    }
</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>





    <div class="c-border p-small border-radius-rounded mt-medium">

        <div class="form-layout form-horizontal form-horizontal-narrow">
            <div class="control-group">
                <label class="control-label"><sub class="control-sub">*</sub> 人员选择（设置队长）：</label>
                <div class="control-form">
                    <textarea class="c-input" rows="5" cols="65" placeholder="请选择人员" data-captain="B06AAE3CB22D45BCB1F88F8CD6CD3C54" data-name="林仙花,林毅" data-id="B06AAE3CB22D45BCB1F88F8CD6CD3C54,662ABB18D95542CF8979A53226AFA53B" id="choose-person-input2">林仙花,林毅</textarea>
                    <a class="button button-primary button-rounded" href="javascript:;" id="choose-person-btn2">选择</a>
                </div>
            </div>
        </div>

        <fieldset class="c-field c-field-title mt-medium">
            <legend class="fs6">人员选择</legend>
        </fieldset>
        <div class="c-field-box c-position-r">
            <div class="c-position-a" style="top: 0; right: 0">
                <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo2" class="border-radius-circle c-border "><i class="iconfont icon-angledown c-gray"></i></a>
            </div>
            <div class="introduce">
                内容区域
            </div>
        </div>

        <div id="collapseTwo2" class="c-panel-bd c-panel-collapse mt-medium">
            <div class="tabs tabs-thr tabs-thr-medium c-position-r" data-toggle="tabs">
                <div class="tabs-hd clearfix">
                    <a href="javascript:;" class="curr"><span>HTML</span></a>
                    <a href="javascript:;"><span>Javascript</span></a>
                </div>
                <div class="tabs-bd">
                    <div class="tabs-bd-box c-hide curr p-small">
<pre><code class="html c-break">
    &lt;div class="form-layout form-horizontal form-horizontal-narrow"&gt;
        &lt;div class="control-group"&gt;
            &lt;label class="control-label"&gt;&lt;sub class="control-sub"&gt;*&lt;/sub&gt; 人员选择：&lt;/label&gt;
            &lt;div class="control-form"&gt;
                &lt;textarea class="c-input" rows="5" cols="65" placeholder="请选择人员" data-captain="B06AAE3CB22D45BCB1F88F8CD6CD3C54" data-name="林仙花,林毅" data-id="B06AAE3CB22D45BCB1F88F8CD6CD3C54,662ABB18D95542CF8979A53226AFA53B" id="choose-person-input2"&gt;林仙花,林毅&lt;/textarea&gt;
                &lt;a class="button button-primary button-rounded" href="javascript:;" id="choose-person-btn2"&gt;选择&lt;/a&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
</code></pre>
                    </div>
                    <div class="tabs-bd-box c-hide p-small">
<pre><code class="javascript">
    $('#choose-person-btn2').on('click',function(){
        chooseperson({
            initDataId:$('#choose-person-input2').attr('data-id'),
            initDataName:$('#choose-person-input2').attr('data-name'),
            ztreeJsonUrl:'../json/chooseperson/choosepersonztree.json',
            searchJsonUrl:'../json/chooseperson/choosepersonsearch.json',
            artDialogTitle: '请选择人员',
            structureStaff:function(id,name){
                var listHtml='';

                if($('#choose-person-input2').attr('data-captain')==id){
                    listHtml+=structureStaffHtml(id,name,true);
                }else{
                    listHtml+=structureStaffHtml(id,name,false);
                }

                return listHtml;
            },
            structureStaffBackArray:function(id,name){
                var valArray =new Array();
                var _captain=$('#selecteBox').find('li.active').length;
                valArray['id']=id;
                valArray['name']=name;
                if(_captain){
                    valArray['captain']=true;
                }else{
                    valArray['captain']=false;
                }
                return valArray;
            },
            callBack:function(value){
                filledData2(value,'#choose-person-input2');
            }
        });
    });

    function structureStaffHtml(id,name,captain){
        var _captain = captain ? 'active' : '';
        var listHtml='&lt;li data-id="'+id+'" data-name="'+name+'" class="'+ _captain +'"&gt;'+
        '&lt;div class="clearfix staff"&gt;'+
            '&lt;span class="fl"&gt;'+name+'&lt;/span&gt;'+
            '&lt;span class="fr"&gt;'+
                                '&lt;i class="iconfont icon-flag c-cursor-p mr-small '+ _captain +'" title="设置为队长" onclick="chooseperson.setCaptainStaff(this)"&gt;&lt;/i&gt;' +
                                '&lt;i class="iconfont icon-close c-cursor-p"  title="删除" onclick="chooseperson.delSelectStaff(this)"&gt;&lt;/i&gt;'+
                            '&lt;/span&gt;'+
            '&lt;/div&gt;&lt;/li&gt;';
        return listHtml;
    }

    chooseperson.setCaptainStaff =function(dom){
        var $ul = $('#selecteBox');
        var $li = $(dom).parents('li');
        $ul.find('li.active').find('i.icon-flag').removeClass('active');
        $ul.find('li.active').removeClass('active');
        $li.addClass('active').find('i.icon-flag').addClass('active');
    };
    chooseperson.delSelectStaff = function(dom){
        var $div = $(dom).parents('div.staff');
        chooseperson.delselect($div.get(0));
    };
    function filledData2(value,dom){
        var _name=_id=captain='';
        $(value).each(function(i,v){
            _name+= v.name+",";
            _id+= v.id+",";
            if(v.captain){
                captain=v.id;
            }
        });
        _name=_name.substring(0,_name.length-1);
        _id=_id.substring(0,_id.length-1);
        $(dom).val(_name).attr({'data-name':_name,'data-id':_id,'data-captain':captain});
    }
</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>




    <div class="mt-big">
        <h2>参数</h2>
        <table class="tb tb-b c-100 mt-small">
            <thead>
            <tr>
                <th class="parameter">名称</th>
                <th class="default">默认值</th>
                <th class="note">描述</th>
            </tr>
            </thead>
            <tbody>
                <tr>
                    <td>htmlId</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>parmOrgData</td>
                    <td>{}</td>
                    <td>组织POST data</td>
                </tr>
                <tr>
                    <td>artDialogTitle</td>
                    <td>‘请选择管理人’</td>
                    <td>弹出窗标题</td>
                </tr>
                <tr>
                    <td>initDataId</td>
                    <td>null</td>
                    <td>初始选中人员id</td>
                </tr>
                <tr>
                    <td>initDataName</td>
                    <td>null</td>
                    <td>初始选中人员name</td>
                </tr>
                <tr>
                    <td>ztreeJsonUrl</td>
                    <td>‘’</td>
                    <td>组织json ajax 地址</td>
                </tr>
                <tr>
                    <td>searchJsonUrl</td>
                    <td>‘’</td>
                    <td>查询json ajax 地址</td>
                </tr>
                <tr>
                    <td>checkType</td>
                    <td>2</td>
                    <td>0无 1单选 2 多选</td>
                </tr>
                <tr>
                    <td>selectNumber</td>
                    <td>10</td>
                    <td>checkType为2时 最多选择几个 默认10个</td>
                </tr>
                <tr>
                    <td>selectPrompt</td>
                    <td>“最多只能选择”</td>
                    <td>checkType为2时 提示语 </td>
                </tr>
                <tr>
                    <td>async</td>
                    <td>false</td>
                    <td>是否异步加载ZTREE</td>
                </tr>
                <tr>
                    <td>ztreeFun</td>
                    <td>
                        <pre>
    {
        Check:null,
        AsyncSuccess:null,
        Click:null
    }
                        </pre>

                    </td>
                    <td>三个函数 {Check:function(){},AsyncSuccess:function(){},Click:function(){}}</td>
                </tr>
                <tr>
                    <td>searchTitle</td>
                    <td>
                        <pre>
    {
        name : '工号',
        numb  : '姓名',
        org  : '组织'
    }
                            </pre>
                    </td>
                    <td>用于搜索结果的表格头信息。</td>
                </tr>
                <tr>
                    <td>searchNameKey</td>
                    <td>'userName'</td>
                    <td>用于搜索时向服务POST的KEY</td>
                </tr>
                <tr>
                    <td>searchRendHtml</td>
                    <td>null</td>
                    <td>用于搜索时生成DOM结构</td>
                </tr>
                <tr>
                    <td>ztreeDataFilter</td>
                    <td>null</td>
                    <td>用于对 Ajax 返回数据进行预处理的函数。例如值是 "data";</td>
                </tr>
                <tr>
                    <td>postAutoParam</td>
                    <td>'id'</td>
                    <td>异步请求POST的KEY值</td>
                </tr>
                <tr>
                    <td>view</td>
                    <td>{}</td>
                    <td>自定义树插件view参数</td>
                </tr>
                <tr>
                    <td>structureStaff</td>
                    <td>null</td>
                    <td>自定义选择后人员列表，返回值(id,name)</td>
                </tr>
                <tr>
                    <td>structureStaffBackArray</td>
                    <td>null</td>
                    <td>自定义选择后人员的返回JSON处理，返回值(id,name)</td>
                </tr>
                <tr>
                    <td>callBackExist</td>
                    <td>null</td>
                    <td>根据条件是否关闭选择人员弹出窗函数</td>
                </tr>
                <tr>
                    <td>statusbar</td>
                    <td>''</td>
                    <td>自定义复选框</td>
                </tr>
                <tr>
                    <td>callBack</td>
                    <td>null</td>
                    <td>回调函数</td>
                </tr>
            </tbody>
        </table>
    </div>

</div>
<script type="text/javascript" src="../js/jquery.js"></script>
<script type="text/javascript" src="../js/cross.js"></script>
<script type="text/javascript" src="../js/highlight/highlight.js"></script>
<script type="text/javascript" src="../js/artdialog/artdialog.js"></script>
<script type="text/javascript" src="../js/ztree/ztree.js"></script>
<script type="text/javascript" src="../js/chooseperson/chooseperson.js"></script>
<script type="text/javascript">
    $(function(){
        $('pre code').each(function(i, block) {
            hljs.highlightBlock(block);
        });
    });
</script>
<script type="text/javascript">
    $(function(){
        $('#choose-person-btn').on('click',function(){
            chooseperson({
                initDataId:$('#choose-person-input').attr('data-id'),
                initDataName:$('#choose-person-input').attr('data-name'),
                ztreeJsonUrl:'../json/chooseperson/choosepersonztree.json',
                searchJsonUrl:'../json/chooseperson/choosepersonsearch.json',
                artDialogTitle: '请选择人员',
                async:true,
                callBack:function(value){
                    filledData(value,'#choose-person-input');
                }
            });
        });
        function filledData(value,dom){
            var _name=_id='';
            $(value).each(function(i,v){
                _name+= v.name+",";
                _id+= v.id+",";
            });
            _name=_name.substring(0,_name.length-1);
            _id=_id.substring(0,_id.length-1);
            $(dom).val(_name).attr({'data-name':_name,'data-id':_id});
        }




        $('#choose-person-btn2').on('click',function(){
            chooseperson({
                initDataId:$('#choose-person-input2').attr('data-id'),
                initDataName:$('#choose-person-input2').attr('data-name'),
                ztreeJsonUrl:'../json/chooseperson/choosepersonztree.json',
                searchJsonUrl:'../json/chooseperson/choosepersonsearch.json',
                artDialogTitle: '请选择人员',
                structureStaff:function(id,name){
                    var listHtml='';

                    if($('#choose-person-input2').attr('data-captain')==id){
                        listHtml+=structureStaffHtml(id,name,true);
                    }else{
                        listHtml+=structureStaffHtml(id,name,false);
                    }

                    return listHtml;
                },
                structureStaffBackArray:function(id,name){
                    var valArray =new Array();
                    var _captain=$('#selecteBox').find('li.active').length;
                    valArray['id']=id;
                    valArray['name']=name;
                    if(_captain){
                        valArray['captain']=true;
                    }else{
                        valArray['captain']=false;
                    }
                    return valArray;
                },
                callBack:function(value){
                    filledData2(value,'#choose-person-input2');
                }
            });
        });

        function structureStaffHtml(id,name,captain){
            var _captain = captain ? 'active' : '';
            var listHtml='<li data-id="'+id+'" data-name="'+name+'" class="'+ _captain +'">'+
                    '<div class="clearfix staff">'+
                        '<span class="fl">'+name+'</span>'+
                        '<span class="fr">'+
                            '<i class="iconfont icon-flag c-cursor-p mr-small '+ _captain +'" title="设置为队长" onclick="chooseperson.setCaptainStaff(this)"></i>' +
                            '<i class="iconfont icon-close c-cursor-p"  title="删除" onclick="chooseperson.delSelectStaff(this)"></i>'+
                        '</span>'+
                    '</div></li>';
            return listHtml;
        }

        chooseperson.setCaptainStaff =function(dom){
            var $ul = $('#selecteBox');
            var $li = $(dom).parents('li');
            $ul.find('li.active').find('i.icon-flag').removeClass('active');
            $ul.find('li.active').removeClass('active');
            $li.addClass('active').find('i.icon-flag').addClass('active');
        };
        chooseperson.delSelectStaff = function(dom){
            var $div = $(dom).parents('div.staff');
            chooseperson.delselect($div.get(0));
        };
        function filledData2(value,dom){
            var _name=_id=captain='';
            $(value).each(function(i,v){
                _name+= v.name+",";
                _id+= v.id+",";
                if(v.captain){
                    captain=v.id;
                }
            });
            _name=_name.substring(0,_name.length-1);
            _id=_id.substring(0,_id.length-1);
            $(dom).val(_name).attr({'data-name':_name,'data-id':_id,'data-captain':captain});
        }
    });
</script>
</body>
</html>

